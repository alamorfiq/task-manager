# Task Manager API

REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏ –Ω–∞ Golang —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º PostgreSQL.

## –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **Go 1.24**
- **PostgreSQL 15** (—á–µ—Ä–µ–∑ Docker)
- **Chi Router** - HTTP —Ä–æ—É—Ç–µ—Ä
- **pgx/v5** - –¥—Ä–∞–π–≤–µ—Ä PostgreSQL
- **cleanenv** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
- **slog** - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
taskmgr/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ server/
‚îÇ       ‚îî‚îÄ‚îÄ main.go                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ local.yaml                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ config/                     # –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ storage/                    # –°–ª–æ–π —Ä–∞–±–æ—Ç—ã —Å –ë–î
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.go              # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ storage.go             # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å Storage
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ postgres/              # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è PostgreSQL
‚îÇ   ‚îú‚îÄ‚îÄ service/                    # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ tasks.go
‚îÇ   ‚îî‚îÄ‚îÄ httpserver/                 # HTTP —Å–ª–æ–π
‚îÇ       ‚îú‚îÄ‚îÄ router.go              # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ—É—Ç–µ—Ä–∞
‚îÇ       ‚îú‚îÄ‚îÄ dto/                   # DTO –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ handlers/              # HTTP —Ö–µ–Ω–¥–ª–µ—Ä—ã
‚îÇ       ‚îî‚îÄ‚îÄ response/              # –•–µ–ª–ø–µ—Ä—ã –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤
‚îú‚îÄ‚îÄ migrations/                     # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ docker-compose.yml             # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ go.mod
```

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL

```bash
docker-compose up -d
```

### 2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å goose (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
go install github.com/pressly/goose/v3/cmd/goose@latest

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
goose -dir migrations postgres "postgresql://taskuser:taskpass@localhost:5432/taskdb?sslmode=disable" up
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# Windows PowerShell
$env:CONFIG_PATH="config/local.yaml"

# Linux/Mac
export CONFIG_PATH="config/local.yaml"
```

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä

```bash
go run cmd/server/main.go
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:8082`

### 5. –û—Ç–∫—Ä—ã—Ç—å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–û—Ç–∫—Ä–æ–π –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏ –Ω–∞ `http://localhost:8082` - –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –∫—Ä–∞—Å–∏–≤—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏! üé®

**–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π API –Ω–∞–ø—Ä—è–º—É—é** (—Å–º. –Ω–∏–∂–µ)

## üé® –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ–π –∏ –∫—Ä–∞—Å–∏–≤—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, –∫–æ—Ç–æ—Ä—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:8082` –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞.

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∏ –æ–ø–∏—Å–∞–Ω–∏–µ–º
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∑–∞–¥–∞—á
- ‚úÖ –û—Ç–º–µ—Ç–∫–∞ –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–≤—Å–µ–≥–æ/–∞–∫—Ç–∏–≤–Ω—ã—Ö/–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö)
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω (—Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö)
- ‚úÖ –ö—Ä–∞—Å–∏–≤–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π UI

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ `web/index.html`
2. –ë—ç–∫–µ–Ω–¥ —Ä–∞–∑–¥–∞–µ—Ç –µ–≥–æ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ (`/`)
3. JavaScript –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ API (`/api/v1/tasks`)
4. CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω, —á—Ç–æ–±—ã —Ñ—Ä–æ–Ω—Ç –∏ –±—ç–∫ –º–æ–≥–ª–∏ –æ–±—â–∞—Ç—å—Å—è

## API Endpoints

### Health Check

```http
GET /health
```

**Response:**
```json
{
  "success": true,
  "data": {
    "status": "ok",
    "time": "2025-12-02T12:00:00Z"
  }
}
```

### –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É

```http
POST /api/v1/tasks
Content-Type: application/json

{
  "title": "–ö—É–ø–∏—Ç—å –º–æ–ª–æ–∫–æ",
  "description": "–í –º–∞–≥–∞–∑–∏–Ω–µ –≤–æ–∑–ª–µ –¥–æ–º–∞"
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "id": 1,
    "title": "–ö—É–ø–∏—Ç—å –º–æ–ª–æ–∫–æ",
    "description": "–í –º–∞–≥–∞–∑–∏–Ω–µ –≤–æ–∑–ª–µ –¥–æ–º–∞",
    "is_done": false,
    "created_at": "2025-12-02T12:00:00Z"
  }
}
```

### –ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞—á—É –ø–æ ID

```http
GET /api/v1/tasks/1
```

**Response:**
```json
{
  "success": true,
  "data": {
    "id": 1,
    "title": "–ö—É–ø–∏—Ç—å –º–æ–ª–æ–∫–æ",
    "description": "–í –º–∞–≥–∞–∑–∏–Ω–µ –≤–æ–∑–ª–µ –¥–æ–º–∞",
    "is_done": false,
    "created_at": "2025-12-02T12:00:00Z"
  }
}
```

### –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–¥–∞—á

```http
GET /api/v1/tasks
```

**Response:**
```json
{
  "success": true,
  "data": {
    "tasks": [
      {
        "id": 1,
        "title": "–ö—É–ø–∏—Ç—å –º–æ–ª–æ–∫–æ",
        "description": "–í –º–∞–≥–∞–∑–∏–Ω–µ –≤–æ–∑–ª–µ –¥–æ–º–∞",
        "is_done": false,
        "created_at": "2025-12-02T12:00:00Z"
      }
    ],
    "count": 1
  }
}
```

### –û—Ç–º–µ—Ç–∏—Ç—å –∑–∞–¥–∞—á—É –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π

```http
PATCH /api/v1/tasks/1/done
```

**Response:**
```json
{
  "success": true,
  "data": {
    "id": 1,
    "title": "–ö—É–ø–∏—Ç—å –º–æ–ª–æ–∫–æ",
    "description": "–í –º–∞–≥–∞–∑–∏–Ω–µ –≤–æ–∑–ª–µ –¥–æ–º–∞",
    "is_done": true,
    "created_at": "2025-12-02T12:00:00Z"
  }
}
```

### –£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É

```http
DELETE /api/v1/tasks/1
```

**Response:**
```json
{
  "success": true,
  "data": {
    "message": "task deleted successfully"
  }
}
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (curl)

```bash
# –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
curl -X POST http://localhost:8082/api/v1/tasks \
  -H "Content-Type: application/json" \
  -d '{"title":"–ö—É–ø–∏—Ç—å –º–æ–ª–æ–∫–æ","description":"–í –º–∞–≥–∞–∑–∏–Ω–µ –≤–æ–∑–ª–µ –¥–æ–º–∞"}'

# –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á
curl http://localhost:8082/api/v1/tasks

# –ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞—á—É –ø–æ ID
curl http://localhost:8082/api/v1/tasks/1

# –û—Ç–º–µ—Ç–∏—Ç—å –∑–∞–¥–∞—á—É –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π
curl -X PATCH http://localhost:8082/api/v1/tasks/1/done

# –£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É
curl -X DELETE http://localhost:8082/api/v1/tasks/1
```

## –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤

–í—Å–µ –æ—Ç–≤–µ—Ç—ã API –∏–º–µ—é—Ç –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "data": { ... }
}
```

**–û—Ç–≤–µ—Ç —Å –æ—à–∏–±–∫–æ–π:**
```json
{
  "success": false,
  "error": "–æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏"
}
```

## HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥—ã

- `200 OK` - —É—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å
- `201 Created` - —Ä–µ—Å—É—Ä—Å —Å–æ–∑–¥–∞–Ω
- `400 Bad Request` - –Ω–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
- `404 Not Found` - —Ä–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
- `500 Internal Server Error` - –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `config/local.yaml`:

```yaml
env: "local"

db:
  host: "localhost"
  port: 5432
  user: "taskuser"
  pass: "taskpass"
  name: "taskdb"

http_server:
  address: "localhost:8082"
  timeout: 4s
  idle_timeout: 60s
```

## Middleware

HTTP —Å–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ middleware:

- **RequestID** - –¥–æ–±–∞–≤–ª—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∫ –∫–∞–∂–¥–æ–º—É –∑–∞–ø—Ä–æ—Å—É
- **RealIP** - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π IP –∫–ª–∏–µ–Ω—Ç–∞
- **Logger** - –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ HTTP –∑–∞–ø—Ä–æ—Å—ã
- **Recoverer** - –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–∞–Ω–∏–∫
- **Timeout** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–∞–π–º–∞—É—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã (60 —Å–µ–∫—É–Ω–¥)

## Graceful Shutdown

–°–µ—Ä–≤–µ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ `SIGINT` –∏–ª–∏ `SIGTERM` (Ctrl+C), –¥–æ–∂–∏–¥–∞—è—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (–º–∞–∫—Å–∏–º—É–º 10 —Å–µ–∫—É–Ω–¥).

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (`slog`):

- **local** - —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç, DEBUG —É—Ä–æ–≤–µ–Ω—å
- **dev** - JSON —Ñ–æ—Ä–º–∞—Ç, DEBUG —É—Ä–æ–≤–µ–Ω—å  
- **prod** - JSON —Ñ–æ—Ä–º–∞—Ç, INFO —É—Ä–æ–≤–µ–Ω—å

–ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–æ–≤:

```
INFO starting task manager env=local
INFO postgres connected successfully
INFO starting http server address=localhost:8082
INFO request completed method=POST path=/api/v1/tasks status=201 duration=15ms
```

## –î–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ

### –ß—Ç–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:

1. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** (JWT)
2. **Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** (swaggo/swag)
3. **–¢–µ—Å—Ç—ã** (unit + integration)
4. **Pagination** –¥–ª—è —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á
5. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –ø–æ–∏—Å–∫** –∑–∞–¥–∞—á
6. **Rate limiting** –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç DDoS
7. **CORS** middleware –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
8. **Docker –æ–±—Ä–∞–∑** –¥–ª—è —Å–∞–º–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
9. **CI/CD** pipeline
10. **–ú–µ—Ç—Ä–∏–∫–∏** (Prometheus)

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

